--Query 1
select e.LASTNAME,e.department_id,d.department_name
from employees e
join DEPARTMENTS d on e.department_id = d.department_id;

--Query 2

select distinct e.JOB_ID,d.LOCATION_ID FROM employees e
join DEPARTMENTS d ON e.DEPARTMENT_ID = d.DEPARTMENT_ID 
where e.DEPARTMENT_ID=30;


--Query 3

select e.LASTNAME,d.DEPARTMENT_NAME,d.LOCATION_ID,l.CITY FROM employees e
join DEPARTMENTS d on e.DEPARTMENT_ID=d.DEPARTMENT_ID
join LOCATIONS l on d.LOCATION_ID = l.LOCATION_ID
where e.COMMISSION_PCT is not null;


---Query 4

select e.LASTNAME,d.DEPARTMENT_NAME from EMPLOYEES e
join DEPARTMENTS d on e.DEPARTMENT_ID= d.DEPARTMENT_ID
where LOWER(e.LASTNAME) LIKE '%a%';

---Query 5

select e.LASTNAME,e.JOB_ID,d.DEPARTMENT_ID,d.DEPARTMENT_NAME FROM EMPLOYEES e
join DEPARTMENTS d on e.DEPARTMENT_ID=d.DEPARTMENT_ID
JOIN LOCATIONS l ON d.LOCATION_ID =l.LOCATION_ID
where l.CITY = 'Toronto';

--6
select e.LASTNAME AS "Employee",e.EMPLOYEE_ID AS "EMP#",m.LASTNAME as "Manager",m.EMPLOYEE_ID AS "Manager#"
from employees e
join EMPLOYEES m on e.MANAGER_ID=m.EMPLOYEE_ID

--7
select e.LASTNAME AS "Employee",e.EMPLOYEE_ID AS "EMP#",m.LASTNAME as "Manager",m.EMPLOYEE_ID AS "Manager#"
from employees e
left join EMPLOYEES m on e.MANAGER_ID=m.EMPLOYEE_ID
order by e.EMPLOYEE_ID


--8
SELECT e.LASTNAME AS "Employee",
       e.DEPARTMENT_ID AS "Dept#",
       c.LASTNAME AS "Colleague"

FROM EMPLOYEES e

JOIN EMPLOYEES c ON e.DEPARTMENT_ID = c.DEPARTMENT_ID

WHERE e.EMPLOYEE_ID <> c.EMPLOYEE_ID

ORDER BY e.DEPARTMENT_ID, e.LASTNAME;

--9

SELECT e.LASTNAME AS "Name",
       e.JOB_ID AS "Job",
       d.DEPARTMENT_NAME AS "Department",
       e.SALARY,
       jg.GRADELEVEL AS "Grade"
FROM EMPLOYEES e
JOIN DEPARTMENTS d ON e.DEPARTMENT_ID = d.DEPARTMENT_ID
JOIN JOBGRADES jg ON e.SALARY BETWEEN jg.LOWEST_SAL AND jg.HIGHEST_SAL;

--10
SELECT LASTNAME,

       HIRE_DATE

FROM EMPLOYEES

WHERE HIRE_DATE > (

    SELECT HIRE_DATE

    FROM EMPLOYEES

    WHERE LASTNAME = 'Davies'

);


--11

SELECT e.LASTNAME AS "Employee",
       e.HIRE_DATE AS "Emp hired",
       m.LASTNAME AS "Manager",
       m.HIRE_DATE AS "Manager hired"
FROM EMPLOYEES e
JOIN EMPLOYEES m ON e.MANAGER_ID = m.EMPLOYEE_ID
WHERE e.HIRE_DATE < m.HIRE_DATE


--12

SELECT MAX(SALARY) AS "Maximum",

       MIN(SALARY) AS "Minimum",

       SUM(SALARY) AS "Sum",

       ROUND(AVG(SALARY), 2) AS "Average"

FROM EMPLOYEES;


--13


SELECT JOB_ID,

       MAX(SALARY) AS Maximum,

       MIN(SALARY) AS Minimum,

       SUM(SALARY) AS Sum,

       ROUND(AVG(SALARY), 2) AS Average

FROM EMPLOYEES

GROUP BY JOB_ID;

--14
SELECT JOB_ID,

       COUNT(*) AS Number_of_People

FROM EMPLOYEES

GROUP BY JOB_ID;

--15

SELECT COUNT(DISTINCT MANAGER_ID) AS "Number of Managers"

FROM EMPLOYEES

WHERE MANAGER_ID IS NOT NULL;

--16

SELECT (MAX(SALARY) - MIN(SALARY)) AS Difference

FROM EMPLOYEES;


--17

SELECT MANAGER_ID,

       MIN(SALARY) AS Lowest_Salary

FROM EMPLOYEES

WHERE MANAGER_ID IS NOT NULL

GROUP BY MANAGER_ID

HAVING MIN(SALARY) >= 6000

ORDER BY Lowest_Salary DESC;


--18

SELECT d.DEPARTMENT_NAME AS Name,

       l.CITY AS Location,

       COUNT(e.EMPLOYEE_ID) AS "No.of people",

       ROUND(AVG(e.SALARY), 2) AS Salary

FROM DEPARTMENTS d

JOIN LOCATIONS l ON d.LOCATION_ID = l.LOCATION_ID

JOIN EMPLOYEES e ON d.DEPARTMENT_ID = e.DEPARTMENT_ID

GROUP BY d.DEPARTMENT_NAME, l.CITY;


--19

SELECT LASTNAME,

       HIRE_DATE

FROM EMPLOYEES

WHERE DEPARTMENT_ID = (

    SELECT DEPARTMENT_ID

    FROM EMPLOYEES

    WHERE LASTNAME = 'Zlotkey'

)

AND LASTNAME <> 'Zlotkey';

--20

SELECT EMPLOYEE_ID,

       LASTNAME,

       SALARY

FROM EMPLOYEES

WHERE SALARY > (SELECT AVG(SALARY) FROM EMPLOYEES)

ORDER BY SALARY ASC;


--21

SELECT e.employee_id, e.LASTNAME
FROM employees e
WHERE e.department_id IN (
    SELECT department_id
    FROM employees
    WHERE LASTNAME LIKE '%u%'
);

--22

SELECT e.LASTNAME, e.department_id, e.job_id
FROM employees e
JOIN departments d ON e.department_id = d.department_id
WHERE d.location_id = 1700;

--23
SELECT e.LASTNAME, e.salary
FROM employees e
JOIN employees m ON e.manager_id = m.employee_id
WHERE m.LASTNAME = 'King';

--24

SELECT e.department_id, e.LASTNAME, e.job_id
FROM employees e
JOIN departments d ON e.department_id = d.department_id
WHERE d.department_name = 'Executive';

--25
SELECT e.employee_id, e.LASTNAME, e.salary
FROM employees e
WHERE e.salary > (
    SELECT AVG(salary) FROM employees
)
AND e.department_id IN (
    SELECT department_id
    FROM employees
    WHERE LASTNAME LIKE '%u%'
);

--26
SELECT DISTINCT department_id
FROM employees;

--27
SELECT *
FROM employees
ORDER BY firstname DESC;


--28
SELECT firstname, LASTNAME, salary, (salary * 0.15) AS PF
FROM employees;

--29
SELECT employee_id, firstname, LASTNAME, salary
FROM employees
ORDER BY salary ASC;

--30
SELECT SUM(salary) AS Total_Salaries
FROM employees;

-- 31
SELECT MAX(SALARY) AS MaximumSalary,
       MIN(SALARY) AS MinimumSalary
FROM employees;

-- 32
SELECT AVG(SALARY) AS AverageSalary,
       COUNT(*) AS NumberOfEmployees
FROM EMPLOYEES;

-- 33
SELECT COUNT(*) AS TotalEmployees
FROM EMPLOYEES;

-- 34
SELECT COUNT(DISTINCT JOB_ID) AS NumberOfJobs
FROM EMPLOYEES;

-- 35
SELECT UPPER(FIRSTNAME) AS FirstNameUpper
FROM EMPLOYEES;

-- 36
SELECT SUBSTRING(FIRSTNAME, 1, 3) AS First3Chars
FROM EMPLOYEES;

-- 37
SELECT FIRSTNAME || ' ' || LASTNAME AS FullName
FROM EMPLOYEES;

-- 38
SELECT LTRIM(RTRIM(FIRSTNAME)) AS TrimmedFirstName
FROM EMPLOYEES;

-- 39
SELECT FIRSTNAME, LASTNAME,
       LEN(FIRSTNAME) AS FirstNameLength,
       LEN(LASTNAME) AS LastNameLength
FROM EMPLOYEES;

-- 40
SELECT FIRSTNAME
FROM EMPLOYEES
WHERE FIRSTNAME LIKE '%[0-9]%';

-- 41
SELECT TOP 10 *
FROM EMPLOYEES;

-- 42
SELECT FIRSTNAME, LASTNAME,
       ROUND(SALARY/12, 2) AS MonthlySalary
FROM EMPLOYEES;

-- 43
SELECT FIRSTNAME, LASTNAME, SALARY
FROM EMPLOYEES
WHERE SALARY NOT BETWEEN 10000 AND 15000;

-- 44
SELECT FIRSTNAME, LASTNAME, DEPARTMENT_ID
FROM EMPLOYEES
WHERE DEPARTMENT_ID IN (30, 100)
ORDER BY DEPARTMENT_ID ASC;

-- 45
SELECT FIRSTNAME, LASTNAME, SALARY, DEPARTMENT_ID
FROM EMPLOYEES
WHERE SALARY NOT BETWEEN 10000 AND 15000
  AND DEPARTMENT_ID IN (30, 100);

-- 46
SELECT FIRSTNAME, LASTNAME, HIRE_DATE
FROM EMPLOYEES
WHERE YEAR(HIRE_DATE) = 1987;

-- 47
SELECT FIRSTNAME
FROM EMPLOYEES
WHERE LOWER(FIRSTNAME) LIKE '%b%'
  AND LOWER(FIRSTNAME) LIKE '%c%';

-- 48
SELECT LASTNAME, JOB_ID, SALARY
FROM EMPLOYEES
WHERE JOB_ID IN ('IT_PROG', 'SH_CLERK')
  AND SALARY NOT IN (4500, 10000, 15000);

-- 49
SELECT LASTNAME
FROM EMPLOYEES
WHERE LEN(LASTNAME) = 6;

-- 50
SELECT LASTNAME
FROM EMPLOYEES
WHERE SUBSTRING(LASTNAME, 3, 1) = 'e';

-- 51
SELECT DISTINCT JOB_ID
FROM EMPLOYEES;

-- 52
SELECT FIRSTNAME, LASTNAME, SALARY,
       SALARY * 0.15 AS PF
FROM EMPLOYEES;

-- 53
SELECT *
FROM EMPLOYEES
WHERE LASTNAME IN ('BLAKE', 'SCOTT', 'KING', 'FORD');

-- 54
SELECT COUNT(DISTINCT JOB_ID) AS JobCount
FROM EMPLOYEES;

-- 55
SELECT SUM(SALARY) AS TotalSalaries
FROM EMPLOYEES;

-- 56
SELECT MIN(SALARY) AS MinimumSalary
FROM EMPLOYEES;

-- 57
SELECT MAX(SALARY) AS MaxProgrammerSalary
FROM EMPLOYEES
WHERE JOB_ID = 'IT_PROG';

-- 58
SELECT AVG(SALARY) AS AverageSalary,
       COUNT(*) AS EmployeeCount
FROM EMPLOYEES
WHERE DEPARTMENT_ID = 90;

-- 59
SELECT MAX(SALARY) AS HighestSalary,
       MIN(SALARY) AS LowestSalary,
       SUM(SALARY) AS TotalSalaries,
       AVG(SALARY) AS AverageSalary
FROM EMPLOYEES;

-- 60
SELECT JOB_ID, COUNT(*) AS EmployeeCount
FROM EMPLOYEES
GROUP BY JOB_ID;
